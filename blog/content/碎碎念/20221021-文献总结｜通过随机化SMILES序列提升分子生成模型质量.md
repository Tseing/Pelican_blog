title: 文献总结｜通过随机化 SMILES 序列提升分子生成模型质量
slug:  summary-doi.org/10.1186/s13321-019-0393-0
date: 2022-10-21
tags: Literature Summary, CADD
summary: 本文介绍于 2019 年发表在 Journal of Cheminformatics 上的一篇文章，文章原标题为 Randomized SMILES strings improve the quality of molecular generative models。
status: draft

本文介绍于 2019 年发表在 <i>Journal of Cheminformatics</i> 上的一篇文章，文章原标题为 <i>Randomized SMILES strings improve the quality of molecular generative models</i>。

<i class="fa fa-external-link"></i> [doi.org/10.1186/s13321-019-0393-0](https://doi.org/10.1186/s13321-019-0393-0)

## 引言

SMILES 是深度学习邻域最常用的化学分子描述方式，在众多研究中使用的 SMILES 都是规范形式（canonical format）。而规范形式的 SMILES 常常会使模型具有一定偏向，还常常导致模型生成大量极相似的分子。文章考查了不同形式的 SMILES 编码对于模型的影响，主要包括规范形式、无约束随机形式和有约束随机形式。

![!n](https://storage.live.com/items/4D18B16B8E0B1EDB!7804?authkey=ALYpzW-ZQ_VBXTU)

例如图片所示，对于阿司匹林分子具有三种不同的编码形式，规范形式（a）是 RDKit 工具中的默认形式。经过随机化后，起始原子发生了变化，无约束形式与有约束形式的区别在于，无约束形式先编码芳环，再编码支链，而有约束形式则先编码支链，最后编码芳环。


## 方法

### SMILES 序列的预处理

对于 SMILES 的预处理在文中被称为 tokenization，其目的是使 SMILES 序列成为能够被神经网络识别的形式。其步骤包括在字列始末加上起始与终止符号、将两个字符的元素（如 Cl 和 Br）视作一个 token 等，最终将 SMILES 序列转化为 one-hot 形式。

### 模型结构

![!n](https://storage.live.com/items/4D18B16B8E0B1EDB!7805?authkey=ALYpzW-ZQ_VBXTU)

分子生成模型由 RNN 构成，经过处理后的 SMILES 序列将逐个 token 进入 $m$ 维的 embedding 层，再进入 $l$ 层大小为 $w$ 的 LSTM 或 GRU 单元，在 RNN 层间也可以设置 dropout 层，最终得到 token 的概率分布 $Y_{ij}$。

### 数据集

GDB-13 数据来自于[官网](https://gdb.unibe.ch/downloads/)，使用 RDKit 对 SMILES 规范化。

ChEMBL 25 数据来自于 ChEMBL 官网，使用 MolVS 0.1.1 数据库对其处理，主要的处理包括去重、去除含有重原子的分子等，最终数据集中的分子都编码为 one-hot 形式。

